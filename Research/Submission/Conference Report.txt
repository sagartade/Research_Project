
Title: 
Can a hybrid of ANN-GARCH model provide a significant improvement in predicting the price volatility of the Ethereum?
======================================================
Abstract:

Ethereum the second most popular cryptocurrency next to Bitcoin has a market share of US $18 billion. Due to its huge market shares, Ethereum has gained attention from the investor community. With its unique ability to write smart contracts for blockchain technologies, it is very popular among the application developers community. Even after having a significantly large fan base, there is very little academic research being done on this cryptocurrency. This research paper aim towards finding out if the hybrid model consisting of ANN-GARCH can provide significant improvements in predicting the price volatility of such popular and volatile cryptocurrency. This research intends to contribute to a better understanding of the ability of the GJR-GARCH model to predict volatility with a rolling window approach. These results when fed to the LSTM model for training and closing the gap between the actual and forecasted volatility values of the GARCH model yield interesting results. After, many iterations and tuning of the GARCH and LSTM models, it was observed that the Root Mean Squared Error (RMSE) was significantly less in comparison with standalone GARCH model. When compared the RMSE with standalone LSTM model the difference observed was very insignificant. This means that the LSTM model is capable enough in predicting the volatility in the case of Ethereum. The question which remains after this research is what factors of GARCH models are preventing it from predicting the highly volatile asset and how it can be optimized for the same.

======================================================
Introduction:

Cryptocurrencies have started gaining huge popularity after the 2008 crisis. With more than US $180 billion being invested in the cryptocurrency markets it is becoming one of the major asset class. <<References 1>> Increase in popularity has attracted every individual's attention towards the cryptocurrency market. Stories of people becoming millionaires overnight are hyping up the interest of the investors and common people. The very high volatile and unregulated market of cryptocurrencies has enabled people in gaining huge profits in recent years. On the other hand, billions of dollars were lost due to the same characteristics causing huge risks to the investors and fund managers creating chaos. Thus various academicians and professionals are trying to solve the problem of predicting the volatility of such cryptocurrencies. Majority of the study is done across one cryptocurrency which is Bitcoin. Origin of Bitcoin was aimed towards overcoming the shortfalls and opaque systems of the traditional banking institutions. The underlying technology of Bitcoin which was termed as "Blockchain" had trust, privacy, transparency and integrity into it by design with the use of advanced maths and technology. Thus the underlying technology of Bitcoin was a great inspiration for other cryptocurrencies and Ethereum in particular.

Ethereum which is the second popular and second most traded cryptocurrency has a capitalization of US $18 billion. With similar underlying technology of blockchain, Ethereum is also used for developing applications based on blockchain technologies. Ethers can be traded for the computation power required to solve a complex math problem for verifying the result. Thus making it unique in itself. One can create its own blockchain application based on Ethereum blockchain thus allowing it to execute applications and transacting the payments. Keeping this unique feature of Ethereum in mind, it was necessary to have research with regards to the prediction of the volatility of this cryptocurrency. Hybridized model of Artificial Neural Network (ANN) and Generalized Autoregressive Conditional Heteroskedasticity (GARCH) was thought of to be best suited for this research. The ability of GARCH models to estimate the volatility of an asset is the central idea of using it. Whereas, ANN is used to detect and minimize the nonlinear effects of volatility. <<References 2>>

This led to the proposal of the research question of:
"Can a hybrid of ANN-GARCH model provide a significant improvement in predicting the price volatility of the Ethereum?" To answer this question, the following milestones were set as objectives.

1) To statistically validate if the Ethereum time series is competent for the use of a proposed hybrid model.
2) To implement a rolling window approach in predicting the volatility by using GARCH and ANN.
3) To compare the hybrid results with the traditional systems and highlight its significance.

<<Image1 Ethereum Price Chart>>

This research is done only on the basis of historical time series data without any consideration of external factors or news or change in governing policies by any influential countries. Any of the above-mentioned factors may imply in a sudden change of prices and volatilities which may be the limitation of this research. It is assumed that the current state of cryptocurrencies continue in the future as they are now. Moving forward with these assumptions, the next section of the report will include a brief review of the literature in the area of cryptocurrencies, volatility predictions using hybrid models and state of the art in the Ethereum price prediction. The proposed methodology to achieve the answers to the questions listed will be discussed after the review based on the literature. Next sections of this research paper will focus in detail on the implementation part following which will be a detailed discussion of the results obtained and how are they interpreted. Thus concluding this research and highlighting the possible future work which can add more value to the current research.



1) Background
2) Importance
3) Research Question
4) Limitations
5) Assumptions
6) Structure of the Report (following sections) "In the next section"


======================================================
Related Work:

Uniqueness of Ethereum as a cryptocurrency

<<Reference14>>


Interestingly a non peer reviewed source suggested that the use of LSTM on financial time series 

======================================================
Methodology

This research follows the CRoss Industry Standard Process for Data Mining which is known as CRISP-DM. It is an industry standard which helps to follow a particular order to achieve the project outcome in data analytics field systematically without missing or skipping any steps. <<References 3>>

1) Business Understanding:

As discussed in the above sections, Ethereum is a unique cryptocurrency in itself. Predicting its prices and volatility is a major challenge in the current time. As there is significantly little work done in predicting its prices it shall be very useful for the investors. Academicians could also know the effects of using a hybrid model for predictions of such highly volatile asset class and know if it is efficient as compared to the traditional data modeling techniques.

2) Data Understanding:

Time series dataset of Ethereum prices is used. This data is scraped from the CoinMarketCap. <<References 1>> Data was available from 07th August 2015. For this particular research last date considered was 27th July 2019. It consists of 1451 observations and 5 attributes namely Date, Open, High, Low, Close. Frequency of this data is daily. Prices mentioned are across US Dollars. Below is the decomposition summary image of the closing prices of Ethereum which is used for this research. It consists of observed, trend, seasonality and randomness in the time series. It suggests the time series had a upward trend till early 2018, thereafter its a declining trend. The randomness during the same time period is very high in this time series indicating sudden changes in he volatility. It also suggests that the time series does not follow any uniform trend and seasonality with it.

<<Image2 Decomposition>>

3) Data Preparation:

It is a vital step in this research. As the data obtained is scraped from online source <<References 1>>, it is raw data. So the next step is to convert this data into time series format for further use. Closing prices of this time series were then selected. A new column is then added to this time series. This new column has the calculated log values of the closing prices. Log values are fed to the models for training the model. Next column which is added to this time series has a difference between current and previous log price. This step was essential for deriving the standard deviation of the corresponding price. As the sliding window approach is adopted for this research, it is necessary to calculate the standard deviation of these lagged log values. Sliding window of 30 observations is decided for this research. Hence the next column which is being added to this time series dataset is of the sliding window standard deviations of the previous 30 observation. The final step in the data preparation is to calculate the volatility of the closing prices. Yang-Zhang estimator for calculating volatility is used as it is independent of the jumps and the drifts in the time series and is also has the assumption that the pricing is continuous which is true in case of Ethereum. Its maximum efficiency is 14 times better than that of close to close estimator. <<Reference 4>>

4) Modeling:

Before proceeding towards the modeling few tests are needed to be done on the volatility derived. These tests will give us the clear idea if the data obtained can be used for the statical modeling. In order to run the GARCH Model, following tests were essential.

The first test which is carried out on the Volatility is the Augmented Dickey Fuller (ADF) test. It is used for checking if the series is stationary or not. The null hypothesis for this test is that the series is not stationary and therefore consists of a presence of unit root. Whereas, the alternative hypothesis is that the series exhibits stationarity. The more the negative value higher is the chance of missing unit root. We can only proceed with this time series if is stationary. On applying this test it was found that the value is -4.2248 and the p-value is 0.01 thus rejecting the null hypothesis and stating that the time series may be stationary. <<Reference 5>>

To confirm the trend stationarity exists and support the ADF, Kwiatkowski-Phillips-Schmidt-Shin (KPSS) test is also used. As opposite to the ADF test, null hypothesis of KPSS states that the series is stationary with deterministic mean that is the series is trend stationary against the null hypothesis stating that the different type of stationarity exists in the time series. As the LM statistic is less than the critical value of 0.05 confidence of 0.463 and the p-value is less than 0.01 states that the null hypothesis is accepted and the series is stationary. <<Reference 6>>

Engle proposed Lagrange Multiplier test which is commonly termed as LM ARCH Test. This test involves fitting of a linear regression model for the squared residuals and then determining whether or not the fitted model is significant <<Reference 7>>. When tested for ARCH presence in Ethereum time series, the null hypothesis stating the absence of ARCH process is rejected. Thus accepting the alternative hypothesis of q degrees of freedom greater than the squared value of X from the distribution and stating the presence of ARCH effect in the time series. The ARCH model is suitable when the time series with error variance follows the autoregressive (AR) model. Similarly, when autoregressive moving average (ARMA) is considered for the error variance, it is then termed as generalized autoregressive conditional heteroskedasticity (GARCH) model. 

Figure below <<Image3>> shows the architectural design of the proposed research. Two main algorithms used here are GJR-GARCH(1,1) and LSTM.

<<Image3 Design1>> <<Reference 13>>

After testing for ARCH presence, moving forward is finding the best GARCH model for this time series. There are total of 11 generalized autoregressive conditional heteroskedasticity (GARCH) models. After, thorough analysis of these models, 3 models are shortlisted for this research. They are EGARCH, QGARCH and GJR-GARCH. Starting with EGARCH model, as GARCH models ignores the sign of the variance thus modeling only magnitude. EGARCH over comes this issue considering negative signs from standard deviation. EGARCH captures the negative shock from the previous time shock t-1 and have a stronger impact for current time t rather than positive shocks. <<Reference 8>> But as the actual time series consists both positive and negative shocks, hence this model was discarded. Second model chosen was QGARCH. Like EGARCH, Quadratic GARCH model can detect the asymmetric positive as well as negative shocks. Addition of the asymmetric term to the vanilla GARCH improved the model significantly. It uses time-varying conditional variances for doing it. <<Reference 9>> According to the paper,<<Reference 10>> GJR-GARCH is the modification of the GARCH-M model. Three main considerations of GJR-GARCH are the seasonal volatility pattern, different impact of positive and negative impact on conditional variance and better prediction of conditional variance. Thus this model is chose for this research as it covers variety of the conditions which a highly volatile time series such as Ethereum can posses. Detail and configuration of this model is discussed in the following section of design specification. 

Second tough choice is to select the appropriate artificial neural network model to reduce the error and train the model. As neural networks does not make any assumptions about the mapping function and promptly learn the linear and nonlinear relations between the data points. Neural networks are also very robust to the error from the input data regardless of the missing values of outliers or sudden changes <<Reference 11>>. By keeping these factors in mind, Multilayer perceptron which is a feed forward type of neural network was sought after. Such kind of neural network are capable in solving most of the classification and non linear types of problems. But, the problems regarding time dependence is its limitation. To overcome this problem, recurrent neural networks (RNN) is a better solution. Among all the RNN's Long Short Term Memory (LSTM) takes into consideration the previous lagged training data and trains the model accordingly. When learning a mapping function, LSTM handles the order from inputs to outputs. Mapping function of LSTM learns to map inputs to outputs over a time period. This capability of LSTM is very useful for this research as volatility of Ethereum is varying widely across the time period t. LSTM thus helps this research by minimizing the error between the predicted volatilities and actual volatilities by using fixed size time windows. <<Reference 12>>

======================================================
Implementation

GJR-GARCH(p,q) model is built where value of p=1 and q=1. Scaled volatility values are then passed through this model for fitting. To generate the rolling forecast volatility, alpha, beta, gamma and omega values obtained from the GJR-GARCH model fitting were required. These values were fetched from the summary of the fitting. Next step in implementation is to solve the GJR-GARCH for each available record and obtain its forecasted volatility base on its t-1 lagged value. GJR-GARCH model is denoted by the formula,

\begin {math} 
~\sigma _{t}^{2}=\omega+~\alpha ~\epsilon _{{t-1}}^{2}+~\beta ~\sigma _{{t-1}}^{2}+~\gamma ~\epsilon _{{t-1}}^{2}I_{{t-1}}
\end {math}

Where, 

\begin {math}
~\epsilon _{t}=~\sigma _{t}z_{t}
\end {math}
and 
\begin {math}
I_{{t-1}}=0
\end {math}

if,
\begin {math}
~\epsilon _{{t-1}}\geq 0
\end {math}

and 
\begin {math}
I_{{t-1}}=1
\end {math}
if
\begin {math}
~\epsilon _{{t-1}}<0
\end {math}

Thus forecasted GJR-GARCH values were plotted against the actual values for visual comparison. Below is the figure showing the forecasted volatility across the actual volatility of Ethereum.

<<Image4 GJR-GARCH_Forecast>> 

Next step involved in implementation phase is to create a training data set for LSTM model with 1121 observations, 1 input layer with 1 node and 1 output for it. That model is then fed to the LSTM with 4 layers, 10 nodes per layer and 0.1 dropout for each layer to regularize. 5th layer was the output layer with 1 node. RNN regressor of tensorflow is used for implementation with 100 epochs and 32 batch size. For dataset of 1421 records, 100 epochs seemed to be optimum based on trial and error. Figure below shows the visual representation of the actual vs predicted rolling LSTM volatility. This research is using "Adam" optimizer for stochastic gradient descent thus optimizing "mean squared error" as a loss function.

<<Image5 LSTM_Forecast>>

To reduce the error in the GJR-GARCH model forecasting, its volatility is fed to the LSTM model along with the normal volatility as a input. Hence the model have 2 input layers and 1 output layer while keeping rest of the parameters same. Moving forward to the next section which contains information about the evaluation of the results obtained.

======================================================
Evaluation


Even though we did not try to build a state of the art LSTM model, yet it is quite impressive, especially on the graphic. However, the graphic might be illusional because we had too many data points in it. That's why we should again measure the goodnes of the model and try to make it better with by combining the garch results.







                   Constant Mean - GJR-GARCH Model Results                    
==============================================================================
Dep. Variable:             Volatility   R-squared:                      -0.252
Mean Model:             Constant Mean   Adj. R-squared:                 -0.252
Vol Model:                  GJR-GARCH   Log-Likelihood:               -45.8285
Distribution:                  Normal   AIC:                           101.657
Method:            Maximum Likelihood   BIC:                           127.953
                                        No. Observations:                 1421
Date:                Sun, Aug 11 2019   Df Residuals:                     1416
Time:                        22:33:58   Df Model:                            5
                               Mean Model                               
========================================================================
                 coef    std err          t      P>|t|  95.0% Conf. Int.
------------------------------------------------------------------------
mu             0.8377  1.104e-02     75.857      0.000 [  0.816,  0.859]
                               Volatility Model                              
=============================================================================
                 coef    std err          t      P>|t|       95.0% Conf. Int.
-----------------------------------------------------------------------------
omega      6.4859e-04  2.170e-04      2.989  2.801e-03  [2.233e-04,1.074e-03]
alpha[1]       1.0000  2.817e-02     35.500 4.973e-276      [  0.945,  1.055]
gamma[1]   2.8570e-08  4.335e-02  6.590e-07      1.000 [-8.497e-02,8.497e-02]
beta[1]    2.3871e-15  1.923e-02  1.242e-13      1.000 [-3.769e-02,3.769e-02]
=============================================================================

======================================================
Conclusion and Future Work


======================================================
References

1) CoinMarketCap. (2019). Cryptocurrency Market Capitalizations | CoinMarketCap. [online] Available at: https://coinmarketcap.com/ [Accessed 13 Apr. 2019].

2) Kristjanpoller, W. and Minutolo, M. (2018). A hybrid volatility forecasting framework integrating GARCH, artificial neural network, technical analysis and principal components analysis. Expert Systems with Applications, 109, pp.1-11.

3) Wirth, R. and Hipp, J., 2000, April. CRISP-DM: Towards a standard process model for data mining. In Proceedings of the 4th international conference on the practical applications of knowledge discovery and data mining (pp. 29-39). Citeseer.

4) Yang Zang Estimator 
Yang, Dennis, and Qiang Zhang. "Drift-Independent Volatility Estimation Based on High, Low, Open, and Close Prices." The Journal of Business 73, no. 3 (2000): 477-92. doi:10.1086/209650.

5) Fuller, W.A., 2009. Introduction to statistical time series (Vol.
428). John Wiley & Sons.

6) Shin, Yongcheol, and Peter Schmidt. "The KPSS stationarity test as a unit root test." Economics Letters 38, no. 4 (1992): 387-392.

7) Engle, R.F., 1982. Autoregressive conditional heteroscedasticity with estimates of the variance of United Kingdom inflation. Econometrica: Journal of the Econometric Society, pp.987-1007.

8) Inequality Constraints in the Univariate GARCH Model

9) Quadratic ARCH Model, Sentana

10) On the Relation between the Expected Value and the Volatility of the Nominal Excess Return on Stocks
https://doi.org/10.1111/j.1540-6261.1993.tb05128.x

11) Forecasting of nonlinear time series using ANN
https://doi.org/10.1016/j.fcij.2017.05.001

12) Applying LSTM to Time Series Predictable through Time-Window Approaches
https://link.springer.com/chapter/10.1007/3-540-44668-0_93


13) https://playground.tensorflow.org/

14) 

======================================================
